local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "Pilgrammed.exe",
    LoadingTitle = "Pilgrammed.exe",
    LoadingSubtitle = "Like and subscribe",
    ConfigurationSaving = {Enabled = false},
    KeySystem = false,
})

local CombatTab = Window:CreateTab("Combat", 4483362458)

local remote = game:GetService("ReplicatedStorage"):WaitForChild("Remotes"):WaitForChild("Block")
local args = {true}
local parryConnection = nil
local lastParryTime = 0

local function startPerfectParry()
    if parryConnection then return end
    
    local player = game:GetService("Players").LocalPlayer
    local checkInterval = 0.08 -- Check ~12 times per second instead of 60
    
    parryConnection = true
    task.spawn(function()
        while parryConnection do
            if tick() - lastParryTime >= 0.12 then -- Parry every 0.12s max
                local char = player.Character
                if char and char:FindFirstChild("HumanoidRootPart") then
                    local rootPos = char.HumanoidRootPart.Position
                    
                    -- Fast spatial query in small radius
                    local parts = workspace:GetPartBoundsInRadius(rootPos, 10)
                    
                    -- Early exit if no parts found
                    if #parts > 0 then
                        for _, part in ipairs(parts) do
                            local name = part.Name
                            if name:find("Projectile") or name:find("Attack") or name:find("Hitbox") or name:find("Damage") then
                                -- Spam burst when attack detected
                                for i = 1, 3 do
                                    remote:FireServer(unpack(args))
                                end
                                lastParryTime = tick()
                                break
                            end
                        end
                    end
                end
            end
            
            task.wait(checkInterval) -- Key optimization: let game breathe
        end
    end)
end

local function stopPerfectParry()
    parryConnection = nil
end

CombatTab:CreateToggle({
    Name = "Auto Parry",
    CurrentValue = false,
    Flag = "AutoParry",
    Callback = function(Value)
        if Value then
            startPerfectParry()
        else
            stopPerfectParry()
        end
    end,
})

game:GetService("UserInputService").InputBegan:Connect(function(input, gP)
    if gP then return end
    if input.KeyCode == Enum.KeyCode.K then
        Rayfield:Toggle()
    end
end)
